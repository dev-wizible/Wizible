<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resume Processor - Complete Workflow with Folder Management</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="style.css" rel="stylesheet" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üöÄ Resume Processor</h1>
        <p>
          Complete workflow with dynamic folder management for processing up to
          5,000 resumes
        </p>
      </div>

      <!-- Folder Management Section -->
      <div class="folder-management">
        <div class="folder-header">
          <div class="folder-title">üìÅ Folder Management</div>
          <div class="folder-actions">
            <button id="createFolderBtn" class="btn-create-folder">
              <span>‚ûï</span>
              Create Folder
            </button>
            <button id="refreshFoldersBtn" class="btn-secondary">
              <span>üîÑ</span>
              Refresh
            </button>
          </div>
        </div>

        <!-- Current Folder Display -->
        <div class="current-folder-display">
          <div class="current-folder-info">
            <div class="current-folder-name">
              <span>üìÇ</span>
              <span>Current Folder:</span>
              <span id="currentFolderName">Loading...</span>
            </div>
            <div class="current-folder-path" id="currentFolderPath">
              Loading path...
            </div>
          </div>
        </div>

        <!-- Folders Grid -->
        <div class="folders-grid" id="foldersGrid">
          <!-- Folders will be populated here -->
        </div>
      </div>

      <!-- Existing Workflow Container -->
      <div class="workflow-container">
        <!-- Step 1: Upload & Convert Resumes -->
        <div class="step-card" id="step1">
          <div class="step-header">
            <div class="step-number">1</div>
            <div class="step-title">Upload & Convert</div>
          </div>
          <div class="step-content">
            <div class="step-description">
              Upload PDF resume files to the current folder and convert them to
              structured JSON using LlamaIndex.
            </div>
            <div class="file-upload-area" id="fileUploadArea">
              <div class="upload-icon">üìÅ</div>
              <div class="upload-text">
                Drop PDF files here or click to browse
              </div>
              <div class="upload-hint">Maximum 5,000 files ‚Ä¢ 10MB per file</div>
              <input
                type="file"
                id="fileInput"
                class="file-input"
                multiple
                accept=".pdf"
              />
            </div>
            <div id="fileList" class="file-list hidden"></div>
          </div>
          <div class="step-actions">
            <button id="convertToJson" class="btn" disabled>
              <span>üîÑ</span>
              Convert to JSON
            </button>
            <button
              id="downloadExtractionsAlways"
              class="btn btn-success"
              disabled
            >
              <span>üì•</span>
              Download JSON Files
            </button>
          </div>
        </div>

        <!-- Step 2: Configure Job -->
        <div class="step-card status-pending" id="step2">
          <div class="step-header">
            <div class="step-number">2</div>
            <div class="step-title">Configure Job</div>
          </div>
          <div class="step-content">
            <div class="step-description">
              Provide job description and evaluation criteria for AI scoring.
            </div>
            <div class="form-group">
              <label class="form-label">Job Description</label>
              <textarea
                id="jobDescription"
                class="form-textarea"
                rows="4"
                placeholder="Enter the complete job description..."
              ></textarea>
            </div>
            <div class="form-group">
              <label class="form-label">Evaluation Rubric</label>
              <textarea
                id="evaluationRubric"
                class="form-textarea"
                rows="4"
                placeholder="Enter evaluation criteria and scoring methodology..."
              ></textarea>
            </div>

            <!-- Google Sheets Configuration -->
            <div class="form-group">
              <label class="form-label"
                >üìä Google Sheets Logging (Optional)</label
              >
              <div
                style="
                  background: #f8fafc;
                  padding: 12px;
                  border-radius: 6px;
                  margin-bottom: 15px;
                  border-left: 4px solid #3b82f6;
                "
              >
                <div
                  style="font-size: 0.9rem; color: #374151; font-weight: 500"
                >
                  üìã How to set up your Google Sheet:
                </div>
                <ol
                  style="
                    margin: 8px 0 0 0;
                    padding-left: 20px;
                    font-size: 0.85rem;
                    color: #6b7280;
                  "
                >
                  <li>Create a new Google Sheet or use an existing one</li>
                  <li>
                    Add your own column headers in row 1 (e.g., "Candidate
                    Name", "Total Score", "Experience Score", etc.)
                  </li>
                  <li>
                    Share the sheet with edit permissions for the service
                    account
                  </li>
                  <li>Copy the Sheet ID from the URL and paste below</li>
                </ol>
                <div
                  style="
                    font-size: 0.8rem;
                    color: #059669;
                    margin-top: 8px;
                    font-style: italic;
                  "
                >
                  ‚ú® The system will automatically map scoring data to your
                  headers!
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">Google Sheet ID</label>
                <input
                  type="text"
                  id="googleSheetId"
                  class="form-input"
                  placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms"
                />
                <div
                  style="font-size: 0.85rem; color: #6b7280; margin-top: 5px"
                >
                  Extract from your Google Sheet URL (between /d/ and /edit)
                </div>
              </div>
              <div class="form-group">
                <label class="form-label"
                  >üìë Sheet Tab Names (One for each AI Model)</label
                >
                <div style="display: grid; gap: 12px">
                  <div>
                    <label
                      class="form-label"
                      style="font-size: 0.9rem; color: #059669"
                      >ü§ñ OpenAI Tab Name</label
                    >
                    <input
                      type="text"
                      id="openaiTabName"
                      class="form-input"
                      placeholder="OpenAI_Results"
                      value="OpenAI_Results"
                    />
                  </div>
                  <div>
                    <label
                      class="form-label"
                      style="font-size: 0.9rem; color: #7c3aed"
                      >üß† Claude Tab Name</label
                    >
                    <input
                      type="text"
                      id="claudeTabName"
                      class="form-input"
                      placeholder="Claude_Results"
                      value="Claude_Results"
                    />
                  </div>
                  <div>
                    <label
                      class="form-label"
                      style="font-size: 0.9rem; color: #dc2626"
                      >‚ú® Gemini Tab Name</label
                    >
                    <input
                      type="text"
                      id="geminiTabName"
                      class="form-input"
                      placeholder="Gemini_Results"
                      value="Gemini_Results"
                    />
                  </div>
                </div>
                <div
                  style="
                    font-size: 0.85rem;
                    color: #6b7280;
                    margin-top: 8px;
                    padding: 8px;
                    background: #f0fdf4;
                    border-radius: 4px;
                  "
                >
                  üí° Each AI model will write its results to a separate tab in
                  your Google Sheet
                </div>
              </div>
            </div>
          </div>
          <button id="saveConfig" class="btn" disabled>
            <span>üíæ</span>
            Save Configuration
          </button>
        </div>

        <!-- Step 3: Review & Start -->
        <div class="step-card status-pending" id="step3">
          <div class="step-header">
            <div class="step-number">3</div>
            <div class="step-title">Review & Start</div>
          </div>
          <div class="step-content">
            <div class="step-description">
              Review extracted JSON files from the current folder and start the
              AI evaluation pipeline.
            </div>

            <!-- Auto-detected Files -->
            <div id="detectedFiles" class="detected-files hidden">
              <div class="detected-header">
                <h4>üìã Detected Files in Current Folder</h4>
                <div class="detected-count">
                  Found <span id="detectedCount">0</span> JSON files ready for
                  evaluation
                </div>
              </div>
              <div id="detectedFilesList" class="detected-list"></div>
            </div>

            <div id="readyToStart" class="ready-section hidden">
              <div class="ready-status">
                <p>
                  <strong>‚úÖ Extraction:</strong>
                  <span id="readyExtracted">0</span> files
                </p>
                <p>
                  <strong>‚öôÔ∏è Configuration:</strong>
                  <span id="readyConfig">Not set</span>
                </p>
                <p>
                  <strong>üöÄ Ready to evaluate:</strong>
                  <span id="readyToEvaluate">0</span> files
                </p>
              </div>
            </div>
          </div>
          <button id="startEvaluation" class="btn btn-success" disabled>
            <span>üöÄ</span>
            Start Evaluation
          </button>
        </div>

        <!-- Step 4: AI Model Evaluation -->
        <div class="step-card status-pending" id="step4">
          <div class="step-header">
            <div class="step-number">4</div>
            <div class="step-title">AI Model Evaluation</div>
          </div>
          <div class="step-content">
            <div class="step-description">
              Configure AI models and run parallel scoring with OpenAI, Claude,
              and Gemini.
            </div>

            <!-- Model Configuration Section -->
            <div id="modelConfigSection" class="model-config-section">
              <div
                style="
                  background: #f8fafc;
                  padding: 20px;
                  border-radius: 12px;
                  margin-bottom: 20px;
                "
              >
                <h4 style="margin: 0 0 15px 0; color: #1f2937">
                  ü§ñ Configure AI Models
                </h4>
                <div style="display: grid; gap: 15px">
                  <div>
                    <label
                      class="form-label"
                      style="font-size: 0.9rem; color: #059669"
                      >ü§ñ OpenAI Model</label
                    >
                    <input
                      type="text"
                      id="openaiModel"
                      class="form-input"
                      placeholder="gpt-4o-mini"
                      value="gpt-4o-mini"
                    />
                    <div
                      style="font-size: 0.8rem; color: #6b7280; margin-top: 4px"
                    >
                      e.g., gpt-4o-mini, gpt-4-turbo, gpt-3.5-turbo
                    </div>
                  </div>
                  <div>
                    <label
                      class="form-label"
                      style="font-size: 0.9rem; color: #7c3aed"
                      >üß† Claude Model</label
                    >
                    <input
                      type="text"
                      id="claudeModel"
                      class="form-input"
                      placeholder="claude-3-5-sonnet-20240620"
                      value="claude-3-5-sonnet-20240620"
                    />
                    <div
                      style="font-size: 0.8rem; color: #6b7280; margin-top: 4px"
                    >
                      e.g., claude-3-5-sonnet-20240620, claude-3-opus-20240229,
                      claude-3-haiku-20240307
                    </div>
                  </div>
                  <div>
                    <label
                      class="form-label"
                      style="font-size: 0.9rem; color: #dc2626"
                      >‚ú® Gemini Model</label
                    >
                    <input
                      type="text"
                      id="geminiModel"
                      class="form-input"
                      placeholder="gemini-pro"
                      value="gemini-pro"
                    />
                    <div
                      style="font-size: 0.8rem; color: #6b7280; margin-top: 4px"
                    >
                      e.g., gemini-pro, gemini-1.5-pro, gemini-1.5-flash
                    </div>
                  </div>
                </div>
              </div>
              <button
                id="startScoring"
                class="btn btn-success"
                style="width: 100%"
              >
                <span>üöÄ</span>
                Start Multi-Model Scoring
              </button>
            </div>

            <!-- OpenAI Scoring Progress -->
            <div
              id="openaiScoringProgress"
              class="evaluation-progress hidden"
              style="margin-top: 20px"
            >
              <div
                class="eval-header"
                style="
                  background: linear-gradient(135deg, #059669 0%, #047857 100%);
                "
              >
                <h4 style="margin: 0">ü§ñ OpenAI Scoring</h4>
                <div class="eval-counter">
                  <span id="openaiScoredCount">0</span> /
                  <span id="openaiTotalToScore">0</span> files
                </div>
              </div>
              <div class="progress-bar">
                <div
                  id="openaiProgressFill"
                  class="progress-fill"
                  style="
                    width: 0%;
                    background: linear-gradient(90deg, #059669, #10b981);
                  "
                ></div>
              </div>
            </div>

            <!-- Claude Scoring Progress -->
            <div
              id="claudeScoringProgress"
              class="evaluation-progress hidden"
              style="margin-top: 15px"
            >
              <div
                class="eval-header"
                style="
                  background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
                "
              >
                <h4 style="margin: 0">üß† Claude Scoring</h4>
                <div class="eval-counter">
                  <span id="claudeScoredCount">0</span> /
                  <span id="claudeTotalToScore">0</span> files
                </div>
              </div>
              <div class="progress-bar">
                <div
                  id="claudeProgressFill"
                  class="progress-fill"
                  style="
                    width: 0%;
                    background: linear-gradient(90deg, #7c3aed, #a78bfa);
                  "
                ></div>
              </div>
            </div>

            <!-- Gemini Scoring Progress -->
            <div
              id="geminiScoringProgress"
              class="evaluation-progress hidden"
              style="margin-top: 15px"
            >
              <div
                class="eval-header"
                style="
                  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
                "
              >
                <h4 style="margin: 0">‚ú® Gemini Scoring</h4>
                <div class="eval-counter">
                  <span id="geminiScoredCount">0</span> /
                  <span id="geminiTotalToScore">0</span> files
                </div>
              </div>
              <div class="progress-bar">
                <div
                  id="geminiProgressFill"
                  class="progress-fill"
                  style="
                    width: 0%;
                    background: linear-gradient(90deg, #dc2626, #f87171);
                  "
                ></div>
              </div>
            </div>

            <!-- All Scoring Complete -->
            <div
              id="allScoringComplete"
              class="evaluation-complete hidden"
              style="margin-top: 20px"
            >
              <div class="complete-header">
                <h4>üéØ All AI Scoring Complete!</h4>
                <div class="complete-summary">
                  <div
                    style="
                      display: grid;
                      gap: 8px;
                      text-align: left;
                      max-width: 400px;
                      margin: 15px auto;
                    "
                  >
                    <div style="display: flex; justify-content: space-between">
                      <span>ü§ñ OpenAI:</span>
                      <strong id="openaiCompleteSummary">0 files</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between">
                      <span>üß† Claude:</span>
                      <strong id="claudeCompleteSummary">0 files</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between">
                      <span>‚ú® Gemini:</span>
                      <strong id="geminiCompleteSummary">0 files</strong>
                    </div>
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  gap: 10px;
                  flex-wrap: wrap;
                  justify-content: center;
                  margin-top: 15px;
                "
              >
                <button id="downloadAllScores" class="btn btn-success">
                  <span>üì•</span>
                  Download All Results
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Status Log Section -->
      <div
        class="progress-section"
        id="progressSection"
        style="
          background: white;
          border-radius: 20px;
          padding: 30px;
          margin-top: 30px;
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        "
      >
        <div class="form-group">
          <label class="form-label">System Status</label>
          <div id="statusLog" class="status-log">
            <div class="log-entry info">
              System ready - select folder and upload resumes to begin...
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Folder Modal -->
    <div class="modal-overlay" id="createFolderModal">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">Create New Folder</div>
          <div class="modal-subtitle">
            Create a new folder for organizing resume processing batches
          </div>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label class="form-label">Folder Name *</label>
            <input
              type="text"
              id="newFolderName"
              class="form-input"
              placeholder="e.g., marketing-2024, senior-engineers"
              maxlength="50"
            />
            <div style="font-size: 0.85rem; color: #6b7280; margin-top: 5px">
              Only letters, numbers, underscores, and hyphens allowed
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Display Name (Optional)</label>
            <input
              type="text"
              id="newFolderDisplayName"
              class="form-input"
              placeholder="e.g., Marketing Team 2024, Senior Engineers"
              maxlength="100"
            />
            <div style="font-size: 0.85rem; color: #6b7280; margin-top: 5px">
              Friendly name for display purposes
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancelCreateFolder" class="btn-secondary">Cancel</button>
          <button id="confirmCreateFolder" class="btn-primary" disabled>
            Create Folder
          </button>
        </div>
      </div>
    </div>

    <!-- Delete Folder Confirmation Modal -->
    <div class="modal-overlay" id="deleteFolderModal">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">Delete Folder</div>
          <div class="modal-subtitle">
            This action will delete the folder and its database table
          </div>
        </div>
        <div class="modal-body">
          <p>
            Are you sure you want to delete the folder "<strong
              id="deleteFolderName"
            ></strong
            >"?
          </p>
          <div
            style="
              margin-top: 15px;
              padding: 15px;
              background: #fee2e2;
              border: 1px solid #fca5a5;
              border-radius: 8px;
              color: #991b1b;
            "
          >
            <strong>‚ö†Ô∏è Warning:</strong> This will permanently delete the
            database table and cannot be undone. All processing data for this
            folder will be lost.
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancelDeleteFolder" class="btn-secondary">Cancel</button>
          <button id="confirmDeleteFolder" class="btn-danger">
            Delete Folder
          </button>
        </div>
      </div>
    </div>
    <script src="script.js"></script>
  </body>
</html>
